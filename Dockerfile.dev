FROM dockerhub.cisco.com/icn-docker/hicn-base-devel-focal:x86_64
WORKDIR /hicn-build

# Get versions from versions.cmake
ARG VERSION_PATH=/tmp/versions.cmake
COPY versions.cmake ${VERSION_PATH}
ARG INSTALL_VPP_SCRIPT=/tmp/install-vpp.sh
COPY scripts/install-vpp.sh ${INSTALL_VPP_SCRIPT}

RUN VERSION_PATH=${VERSION_PATH} bash -x ${INSTALL_VPP_SCRIPT}
RUN apt update && apt-get install -y          \
  libssl-dev                                  \
  iproute2                                    \
  iperf3                                      \
  iputils-ping                                \
  tcpdump                                     \
  gdb --no-install-recommends
